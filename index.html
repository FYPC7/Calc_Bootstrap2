<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bootstrap - Ejercicios Estad√≠sticos</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #ffeef4, #e8f4f8, #f0f8e8, #fff5e8);
            min-height: 100vh;
            color: #5a5a5a;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #f8d7da, #d4f6e8);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .header h1 {
            color: #6c5b7b;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .header p {
            color: #8b7d8b;
            font-size: 1.1rem;
        }

        .exercise-selector {
            background: linear-gradient(45deg, #e8f4f8, #ffeef4);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }

        .exercise-selector h3 {
            color: #5a85a1;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .exercise-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .exercise-btn {
            background: linear-gradient(45deg, #c8e6c9, #b3e5fc);
            border: none;
            padding: 15px 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #4a6741;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .exercise-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .exercise-btn.active {
            background: linear-gradient(45deg, #ffcdd2, #d1c4e9);
            color: #6a4c93;
        }

        .exercise-content {
            background: #ffffff;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            border: 2px solid #f0f0f0;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #6c5b7b;
            font-weight: 600;
        }

        .input-group input, .input-group textarea, .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e8e8e8;
            border-radius: 10px;
            font-size: 14px;
            transition: border-color 0.3s ease;
            background: #fafafa;
        }

        .input-group input:focus, .input-group textarea:focus, .input-group select:focus {
            outline: none;
            border-color: #b3e5fc;
            background: #ffffff;
        }

        .input-row {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 15px;
            align-items: end;
        }

        .calculate-btn {
            background: linear-gradient(45deg, #81c784, #64b5f6);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.25);
        }

        .results {
            background: linear-gradient(135deg, #f0f8e8, #e8f4f8);
            padding: 25px;
            border-radius: 15px;
            margin-top: 25px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }

        .results h4 {
            color: #4a6741;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .result-item {
            background: white;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            border-left: 4px solid #81c784;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        #histogramCanvas {
            max-width: 100%;
            height: 300px;
            border-radius: 10px;
        }

        .loading {
            text-align: center;
            color: #81c784;
            font-style: italic;
            padding: 20px;
        }

        .error {
            background: #ffebee;
            color: #c62828;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #f44336;
            margin-top: 10px;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ Bootstrap Estad√≠stico</h1>
            <p>Aplicaci√≥n interactiva para resolver ejercicios de remuestreo Bootstrap</p>
        </div>

        <div class="exercise-selector">
            <h3>üìä Selecciona un Ejercicio</h3>
            <div class="exercise-grid">
                <button class="exercise-btn active" onclick="selectExercise(1)">Ejercicio 1: Media</button>
                <button class="exercise-btn" onclick="selectExercise(2)">Ejercicio 2: Dos Medias</button>
                <button class="exercise-btn" onclick="selectExercise(3)">Ejercicio 3: Proporciones</button>
                <button class="exercise-btn" onclick="selectExercise(4)">Ejercicio 4: Correlaci√≥n</button>
                <button class="exercise-btn" onclick="selectExercise(5)">Ejercicio 5: Mediana</button>
                <button class="exercise-btn" onclick="selectExercise(6)">Ejercicio 6: Varianzas</button>
                <button class="exercise-btn" onclick="selectExercise(7)">Ejercicio 7: Regresi√≥n</button>
                <button class="exercise-btn" onclick="selectExercise(8)">Ejercicio 8: Dif. Proporciones</button>
                <button class="exercise-btn" onclick="selectExercise(9)">Ejercicio 9: Param√©trico</button>
                <button class="exercise-btn" onclick="selectExercise(10)">Ejercicio 10: Dependientes</button>
            </div>
        </div>

        <div id="exerciseContent" class="exercise-content">
            <!-- Exercise 1: Media -->
            <div id="exercise1" class="exercise">
                <h3>üìà Ejercicio 1: Estimaci√≥n de la Media</h3>
                <p><strong>Contexto:</strong> Pesos de productos manufacturados (en gramos)</p>
                
                <div class="input-group">
                    <label>Datos (separados por comas):</label>
                    <textarea id="data1" rows="3" placeholder="502, 498, 505, 501, 499, 503, 497, 504, 500, 502, 498, 506, 499, 501, 504">502, 498, 505, 501, 499, 503, 497, 504, 500, 502, 498, 506, 499, 501, 504</textarea>
                </div>
                
                <div class="input-row">
                    <div class="input-group">
                        <label>Nivel de Confianza (%):</label>
                        <select id="confidence1">
                            <option value="90">90%</option>
                            <option value="95" selected>95%</option>
                            <option value="99">99%</option>
                        </select>
                    </div>
                    <button class="calculate-btn" onclick="calculateExercise1()">Calcular Bootstrap</button>
                </div>
                
                <div id="results1" class="results hidden"></div>
            </div>

            <!-- Exercise 2: Dos Medias -->
            <div id="exercise2" class="exercise hidden">
                <h3>‚öñÔ∏è Ejercicio 2: Comparaci√≥n de Dos Medias</h3>
                <p><strong>Contexto:</strong> Tiempo de respuesta de dos sistemas (en milisegundos)</p>
                
                <div class="input-group">
                    <label>Sistema A:</label>
                    <textarea id="dataA2" rows="2" placeholder="120, 115, 125, 118, 122, 119, 123, 117, 121, 124">120, 115, 125, 118, 122, 119, 123, 117, 121, 124</textarea>
                </div>
                
                <div class="input-group">
                    <label>Sistema B:</label>
                    <textarea id="dataB2" rows="2" placeholder="135, 132, 138, 134, 136, 133, 139, 131, 137, 140">135, 132, 138, 134, 136, 133, 139, 131, 137, 140</textarea>
                </div>
                
                <div class="input-row">
                    <div class="input-group">
                        <label>Nivel de Confianza (%):</label>
                        <select id="confidence2">
                            <option value="90">90%</option>
                            <option value="95" selected>95%</option>
                            <option value="99">99%</option>
                        </select>
                    </div>
                    <button class="calculate-btn" onclick="calculateExercise2()">Calcular Bootstrap</button>
                </div>
                
                <div id="results2" class="results hidden"></div>
            </div>

            <!-- Exercise 3: Proporciones -->
            <div id="exercise3" class="exercise hidden">
                <h3>üéØ Ejercicio 3: Estimaci√≥n de Proporciones</h3>
                <p><strong>Contexto:</strong> √âxito en tratamiento m√©dico (1 = √©xito, 0 = fallo)</p>
                
                <div class="input-group">
                    <label>Datos (0s y 1s separados por comas):</label>
                    <textarea id="data3" rows="3" placeholder="1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1">1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1</textarea>
                </div>
                
                <div class="input-row">
                    <div class="input-group">
                        <label>Nivel de Confianza (%):</label>
                        <select id="confidence3">
                            <option value="90" selected>90%</option>
                            <option value="95">95%</option>
                            <option value="99">99%</option>
                        </select>
                    </div>
                    <button class="calculate-btn" onclick="calculateExercise3()">Calcular Bootstrap</button>
                </div>
                
                <div id="results3" class="results hidden"></div>
            </div>

            <!-- Exercise 4: Correlaci√≥n -->
            <div id="exercise4" class="exercise hidden">
                <h3>üìä Ejercicio 4: Correlaci√≥n Bootstrap</h3>
                <p><strong>Contexto:</strong> Relaci√≥n entre horas de estudio y calificaciones</p>
                
                <div class="input-group">
                    <label>Horas de estudio:</label>
                    <textarea id="dataX4" rows="2" placeholder="2, 4, 3, 5, 1, 6, 3, 4, 2, 5, 7, 3, 4, 6, 2">2, 4, 3, 5, 1, 6, 3, 4, 2, 5, 7, 3, 4, 6, 2</textarea>
                </div>
                
                <div class="input-group">
                    <label>Calificaciones:</label>
                    <textarea id="dataY4" rows="2" placeholder="65, 78, 72, 85, 58, 88, 70, 79, 63, 82, 92, 68, 75, 86, 61">65, 78, 72, 85, 58, 88, 70, 79, 63, 82, 92, 68, 75, 86, 61</textarea>
                </div>
                
                <div class="input-row">
                    <div class="input-group">
                        <label>Nivel de Confianza (%):</label>
                        <select id="confidence4">
                            <option value="90">90%</option>
                            <option value="95" selected>95%</option>
                            <option value="99">99%</option>
                        </select>
                    </div>
                    <button class="calculate-btn" onclick="calculateExercise4()">Calcular Bootstrap</button>
                </div>
                
                <div id="results4" class="results hidden"></div>
            </div>

            <!-- Exercise 5: Mediana -->
            <div id="exercise5" class="exercise hidden">
                <h3>üìä Ejercicio 5: Mediana y Percentiles</h3>
                <p><strong>Contexto:</strong> Ingresos mensuales de empleados (en miles)</p>
                
                <div class="input-group">
                    <label>Datos:</label>
                    <textarea id="data5" rows="3" placeholder="2.5, 3.2, 2.8, 3.5, 2.9, 3.1, 2.7, 3.4, 3.0, 3.3, 2.6, 3.6, 2.9, 3.2, 2.8, 3.1, 2.7, 3.3, 3.0, 2.9">2.5, 3.2, 2.8, 3.5, 2.9, 3.1, 2.7, 3.4, 3.0, 3.3, 2.6, 3.6, 2.9, 3.2, 2.8, 3.1, 2.7, 3.3, 3.0, 2.9</textarea>
                </div>
                
                <div class="input-row">
                    <div class="input-group">
                        <label>Nivel de Confianza (%):</label>
                        <select id="confidence5">
                            <option value="90">90%</option>
                            <option value="95" selected>95%</option>
                            <option value="99">99%</option>
                        </select>
                    </div>
                    <button class="calculate-btn" onclick="calculateExercise5()">Calcular Bootstrap</button>
                </div>
                
                <div id="results5" class="results hidden"></div>
            </div>

            <!-- Exercise 6: Varianzas -->
            <div id="exercise6" class="exercise hidden">
                <h3>‚öñÔ∏è Ejercicio 6: Raz√≥n de Varianzas</h3>
                <p><strong>Contexto:</strong> Variabilidad en dos procesos de producci√≥n</p>
                
                <div class="input-group">
                    <label>Proceso 1:</label>
                    <textarea id="dataA6" rows="2" placeholder="45.2, 44.8, 45.5, 44.9, 45.1, 45.0, 44.7, 45.3, 44.6, 45.4">45.2, 44.8, 45.5, 44.9, 45.1, 45.0, 44.7, 45.3, 44.6, 45.4</textarea>
                </div>
                
                <div class="input-group">
                    <label>Proceso 2:</label>
                    <textarea id="dataB6" rows="2" placeholder="43.8, 44.5, 43.2, 44.1, 43.9, 44.3, 43.6, 44.0, 43.7, 44.2">43.8, 44.5, 43.2, 44.1, 43.9, 44.3, 43.6, 44.0, 43.7, 44.2</textarea>
                </div>
                
                <div class="input-row">
                    <div class="input-group">
                        <label>Nivel de Confianza (%):</label>
                        <select id="confidence6">
                            <option value="90">90%</option>
                            <option value="95" selected>95%</option>
                            <option value="99">99%</option>
                        </select>
                    </div>
                    <button class="calculate-btn" onclick="calculateExercise6()">Calcular Bootstrap</button>
                </div>
                
                <div id="results6" class="results hidden"></div>
            </div>

            <!-- Exercise 7: Regresi√≥n -->
            <div id="exercise7" class="exercise hidden">
                <h3>üìà Ejercicio 7: Bootstrap en Regresi√≥n</h3>
                <p><strong>Contexto:</strong> Predicci√≥n de ventas basada en publicidad</p>
                
                <div class="input-group">
                    <label>Publicidad (x):</label>
                    <textarea id="dataX7" rows="2" placeholder="10, 15, 20, 25, 30, 35, 40, 45, 50, 55">10, 15, 20, 25, 30, 35, 40, 45, 50, 55</textarea>
                </div>
                
                <div class="input-group">
                    <label>Ventas (y):</label>
                    <textarea id="dataY7" rows="2" placeholder="23, 28, 35, 41, 46, 52, 58, 63, 69, 74">23, 28, 35, 41, 46, 52, 58, 63, 69, 74</textarea>
                </div>
                
                <div class="input-row">
                    <div class="input-group">
                        <label>Nivel de Confianza (%):</label>
                        <select id="confidence7">
                            <option value="90">90%</option>
                            <option value="95" selected>95%</option>
                            <option value="99">99%</option>
                        </select>
                    </div>
                    <button class="calculate-btn" onclick="calculateExercise7()">Calcular Bootstrap</button>
                </div>
                
                <div id="results7" class="results hidden"></div>
            </div>

            <!-- Exercise 8: Diferencia Proporciones -->
            <div id="exercise8" class="exercise hidden">
                <h3>‚öñÔ∏è Ejercicio 8: Diferencia de Proporciones</h3>
                <p><strong>Contexto:</strong> Efectividad de dos tratamientos</p>
                
                <div class="input-group">
                    <label>Tratamiento A (0s y 1s):</label>
                    <textarea id="dataA8" rows="2" placeholder="1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1">1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1</textarea>
                </div>
                
                <div class="input-group">
                    <label>Tratamiento B (0s y 1s):</label>
                    <textarea id="dataB8" rows="2" placeholder="1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0">1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0</textarea>
                </div>
                
                <div class="input-row">
                    <div class="input-group">
                        <label>Nivel de Confianza (%):</label>
                        <select id="confidence8">
                            <option value="90">90%</option>
                            <option value="95" selected>95%</option>
                            <option value="99">99%</option>
                        </select>
                    </div>
                    <button class="calculate-btn" onclick="calculateExercise8()">Calcular Bootstrap</button>
                </div>
                
                <div id="results8" class="results hidden"></div>
            </div>

            <!-- Exercise 9: Param√©trico -->
            <div id="exercise9" class="exercise hidden">
                <h3>üìä Ejercicio 9: Bootstrap Param√©trico</h3>
                <p><strong>Contexto:</strong> Tiempo hasta fallo de componentes electr√≥nicos (d√≠as) - Distribuci√≥n Exponencial</p>
                
                <div class="input-group">
                    <label>Datos:</label>
                    <textarea id="data9" rows="3" placeholder="145, 167, 132, 178, 156, 143, 189, 134, 165, 152, 171, 148, 163, 139, 175">145, 167, 132, 178, 156, 143, 189, 134, 165, 152, 171, 148, 163, 139, 175</textarea>
                </div>
                
                <div class="input-row">
                    <div class="input-group">
                        <label>Nivel de Confianza (%):</label>
                        <select id="confidence9">
                            <option value="90">90%</option>
                            <option value="95" selected>95%</option>
                            <option value="99">99%</option>
                        </select>
                    </div>
                    <button class="calculate-btn" onclick="calculateExercise9()">Calcular Bootstrap</button>
                </div>
                
                <div id="results9" class="results hidden"></div>
            </div>

            <!-- Exercise 10: Dependientes -->
            <div id="exercise10" class="exercise hidden">
                <h3>üìà Ejercicio 10: Bootstrap con Datos Dependientes</h3>
                <p><strong>Contexto:</strong> Retornos diarios de acciones (%) - Bootstrap por bloques</p>
                
                <div class="input-group">
                    <label>Datos:</label>
                    <textarea id="data10" rows="3" placeholder="0.5, 1.2, -0.3, 0.8, 1.1, -0.6, 0.4, 0.9, -0.2, 1.3, 0.7, -0.4, 0.6, 1.0, -0.1, 0.8, 1.2, -0.5, 0.3, 0.9">0.5, 1.2, -0.3, 0.8, 1.1, -0.6, 0.4, 0.9, -0.2, 1.3, 0.7, -0.4, 0.6, 1.0, -0.1, 0.8, 1.2, -0.5, 0.3, 0.9</textarea>
                </div>
                
                <div class="input-row">
                    <div class="input-group">
                        <label>Tama√±o de Bloque:</label>
                        <input type="number" id="blockSize10" value="4" min="2" max="10">
                    </div>
                    <div class="input-group">
                        <label>Nivel de Confianza (%):</label>
                        <select id="confidence10">
                            <option value="90">90%</option>
                            <option value="95" selected>95%</option>
                            <option value="99">99%</option>
                        </select>
                    </div>
                    <button class="calculate-btn" onclick="calculateExercise10()">Calcular Bootstrap</button>
                </div>
                
                <div id="results10" class="results hidden"></div>
            </div>
        </div>

        <div class="chart-container hidden" id="chartContainer">
            <h4>üìä Distribuci√≥n Bootstrap</h4>
            <canvas id="histogramCanvas"></canvas>
        </div>
    </div>

    <script>
        let currentExercise = 1;
        let bootstrapSamples = 1000;

        function selectExercise(exerciseNum) {
            // Update active button
            document.querySelectorAll('.exercise-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Hide all exercises
            document.querySelectorAll('.exercise').forEach(ex => ex.classList.add('hidden'));
            
            // Show selected exercise
            document.getElementById(`exercise${exerciseNum}`).classList.remove('hidden');
            
            // Hide results and chart
            document.getElementById(`results${currentExercise}`).classList.add('hidden');
            document.getElementById('chartContainer').classList.add('hidden');
            
            currentExercise = exerciseNum;
        }

        function parseData(dataString) {
            return dataString.split(',').map(x => parseFloat(x.trim())).filter(x => !isNaN(x));
        }

        function mean(arr) {
            return arr.reduce((a, b) => a + b, 0) / arr.length;
        }

        function variance(arr) {
            const m = mean(arr);
            return arr.reduce((sum, x) => sum + Math.pow(x - m, 2), 0) / (arr.length - 1);
        }

        function standardDeviation(arr) {
            return Math.sqrt(variance(arr));
        }

        function median(arr) {
            const sorted = [...arr].sort((a, b) => a - b);
            const mid = Math.floor(sorted.length / 2);
            return sorted.length % 2 !== 0 ? sorted[mid] : (sorted[mid - 1] + sorted[mid]) / 2;
        }

        function percentile(arr, p) {
            const sorted = [...arr].sort((a, b) => a - b);
            const index = (p / 100) * (sorted.length - 1);
            const lower = Math.floor(index);
            const upper = Math.ceil(index);
            const weight = index % 1;
            return sorted[lower] * (1 - weight) + sorted[upper] * weight;
        }

        function correlation(x, y) {
            const n = x.length;
            const sumX = x.reduce((a, b) => a + b, 0);
            const sumY = y.reduce((a, b) => a + b, 0);
            const sumXY = x.reduce((sum, xi, i) => sum + xi * y[i], 0);
            const sumX2 = x.reduce((sum, xi) => sum + xi * xi, 0);
            const sumY2 = y.reduce((sum, yi) => sum + yi * yi, 0);
            
            return (n * sumXY - sumX * sumY) / Math.sqrt((n * sumX2 - sumX * sumX) * (n * sumY2 - sumY * sumY));
        }

        function linearRegression(x, y) {
            const n = x.length;
            const sumX = x.reduce((a, b) => a + b, 0);
            const sumY = y.reduce((a, b) => a + b, 0);
            const sumXY = x.reduce((sum, xi, i) => sum + xi * y[i], 0);
            const sumX2 = x.reduce((sum, xi) => sum + xi * xi, 0);
            
            const slope = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);
            const intercept = (sumY - slope * sumX) / n;
            
            return { slope, intercept };
        }

        function bootstrap(data, statFunc, samples = 1000) {
            const results = [];
            for (let i = 0; i < samples; i++) {
                const sample = [];
                for (let j = 0; j < data.length; j++) {
                    sample.push(data[Math.floor(Math.random() * data.length)]);
                }
                results.push(statFunc(sample));
            }
            return results;
        }

        function confidenceInterval(data, confidence) {
            const sorted = [...data].sort((a, b) => a - b);
            const alpha = (100 - confidence) / 100;
            const lower = Math.floor(alpha / 2 * sorted.length);
            const upper = Math.floor((1 - alpha / 2) * sorted.length);
            return [sorted[lower], sorted[upper]];
        }

        function showResults(exerciseNum, results) {
            const resultsDiv = document.getElementById(`results${exerciseNum}`);
            resultsDiv.innerHTML = results;
            resultsDiv.classList.remove('hidden');
        }

        function createHistogram(data, title) {
            const canvas = document.getElementById('histogramCanvas');
            const ctx = canvas.getContext('2d');
            
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Set canvas size
            canvas.width = 600;
            canvas.height = 300;
            
            // Calculate histogram
            const bins = 30;
            const min = Math.min(...data);
            const max = Math.max(...data);
            const binWidth = (max - min) / bins;
            const histogram = new Array(bins).fill(0);
            
            data.forEach(value => {
                const binIndex = Math.min(Math.floor((value - min) / binWidth), bins - 1);
                histogram[binIndex]++;
            });
            
            // Draw histogram
            const barWidth = canvas.width / bins;
            const maxHeight = Math.max(...histogram);
            
            ctx.fillStyle = '#81c784';
            histogram.forEach((count, i) => {
                const barHeight = (count / maxHeight) * (canvas.height - 40);
                ctx.fillRect(i * barWidth, canvas.height - barHeight - 20, barWidth - 1, barHeight);
            });
            
            // Add title
            ctx.fillStyle = '#5a85a1';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(title, canvas.width / 2, 20);
            
            document.getElementById('chartContainer').classList.remove('hidden');
        }

        // Exercise 1: Media
        function calculateExercise1() {
            try {
                const data = parseData(document.getElementById('data1').value);
                const confidence = parseInt(document.getElementById('confidence1').value);
                
                if (data.length < 2) {
                    throw new Error('Se necesitan al menos 2 datos');
                }
                
                const originalMean = mean(data);
                const bootstrapMeans = bootstrap(data, mean, bootstrapSamples);
                const [lower, upper] = confidenceInterval(bootstrapMeans, confidence);
                
                const results = `
                    <h4>üéØ Resultados - Estimaci√≥n de la Media</h4>
                    <div class="result-item">
                        <strong>üìä Media Original:</strong> ${originalMean.toFixed(4)} gramos
                    </div>
                    <div class="result-item">
                        <strong>üî¢ Media Bootstrap:</strong> ${mean(bootstrapMeans).toFixed(4)} gramos
                    </div>
                    <div class="result-item">
                        <strong>üìà Intervalo de Confianza ${confidence}%:</strong> [${lower.toFixed(4)}, ${upper.toFixed(4)}] gramos
                    </div>
                    <div class="result-item">
                        <strong>üí° Interpretaci√≥n:</strong> Con ${confidence}% de confianza, la media poblacional de los pesos est√° entre ${lower.toFixed(2)} y ${upper.toFixed(2)} gramos.
                    </div>
                `;
                
                showResults(1, results);
                createHistogram(bootstrapMeans, 'Distribuci√≥n Bootstrap de la Media');
                
            } catch (error) {
                showResults(1, `<div class="error">‚ùå Error: ${error.message}</div>`);
            }
        }

        // Exercise 2: Dos Medias
        function calculateExercise2() {
            try {
                const dataA = parseData(document.getElementById('dataA2').value);
                const dataB = parseData(document.getElementById('dataB2').value);
                const confidence = parseInt(document.getElementById('confidence2').value);
                
                if (dataA.length < 2 || dataB.length < 2) {
                    throw new Error('Cada sistema necesita al menos 2 datos');
                }
                
                const meanA = mean(dataA);
                const meanB = mean(dataB);
                const difference = meanA - meanB;
                
                const bootstrapDifferences = [];
                for (let i = 0; i < bootstrapSamples; i++) {
                    const sampleA = bootstrap(dataA, mean, 1)[0];
                    const sampleB = bootstrap(dataB, mean, 1)[0];
                    bootstrapDifferences.push(sampleA - sampleB);
                }
                
                const [lower, upper] = confidenceInterval(bootstrapDifferences, confidence);
                const significantDiff = (lower > 0 && upper > 0) || (lower < 0 && upper < 0);
                
                const results = `
                    <h4>‚öñÔ∏è Resultados - Comparaci√≥n de Dos Medias</h4>
                    <div class="result-item">
                        <strong>üìä Media Sistema A:</strong> ${meanA.toFixed(4)} ms
                    </div>
                    <div class="result-item">
                        <strong>üìä Media Sistema B:</strong> ${meanB.toFixed(4)} ms
                    </div>
                    <div class="result-item">
                        <strong>üî¢ Diferencia (A - B):</strong> ${difference.toFixed(4)} ms
                    </div>
                    <div class="result-item">
                        <strong>üìà IC ${confidence}% para la diferencia:</strong> [${lower.toFixed(4)}, ${upper.toFixed(4)}] ms
                    </div>
                    <div class="result-item">
                        <strong>üí° Interpretaci√≥n:</strong> ${significantDiff ? 
                            `Hay diferencia significativa entre los sistemas. El Sistema ${difference > 0 ? 'B es m√°s r√°pido' : 'A es m√°s r√°pido'}.` : 
                            'No hay diferencia significativa entre los sistemas (el IC incluye el 0).'}
                    </div>
                `;
                
                showResults(2, results);
                createHistogram(bootstrapDifferences, 'Distribuci√≥n Bootstrap de la Diferencia de Medias');
                
            } catch (error) {
                showResults(2, `<div class="error">‚ùå Error: ${error.message}</div>`);
            }
        }

        // Exercise 3: Proporciones
        function calculateExercise3() {
            try {
                const data = parseData(document.getElementById('data3').value);
                const confidence = parseInt(document.getElementById('confidence3').value);
                
                if (data.length < 2) {
                    throw new Error('Se necesitan al menos 2 datos');
                }
                
                if (!data.every(x => x === 0 || x === 1)) {
                    throw new Error('Los datos deben ser solo 0s y 1s');
                }
                
                const originalProp = mean(data);
                const bootstrapProps = bootstrap(data, mean, bootstrapSamples);
                const [lower, upper] = confidenceInterval(bootstrapProps, confidence);
                
                const results = `
                    <h4>üéØ Resultados - Estimaci√≥n de Proporciones</h4>
                    <div class="result-item">
                        <strong>üìä Proporci√≥n de √âxito:</strong> ${(originalProp * 100).toFixed(2)}% (${data.filter(x => x === 1).length}/${data.length})
                    </div>
                    <div class="result-item">
                        <strong>üî¢ Proporci√≥n Bootstrap:</strong> ${(mean(bootstrapProps) * 100).toFixed(2)}%
                    </div>
                    <div class="result-item">
                        <strong>üìà Intervalo de Confianza ${confidence}%:</strong> [${(lower * 100).toFixed(2)}%, ${(upper * 100).toFixed(2)}%]
                    </div>
                    <div class="result-item">
                        <strong>üí° Interpretaci√≥n:</strong> Con ${confidence}% de confianza, la proporci√≥n real de √©xito del tratamiento est√° entre ${(lower * 100).toFixed(1)}% y ${(upper * 100).toFixed(1)}%.
                    </div>
                `;
                
                showResults(3, results);
                createHistogram(bootstrapProps, 'Distribuci√≥n Bootstrap de la Proporci√≥n');
                
            } catch (error) {
                showResults(3, `<div class="error">‚ùå Error: ${error.message}</div>`);
            }
        }

        // Exercise 4: Correlaci√≥n
        function calculateExercise4() {
            try {
                const dataX = parseData(document.getElementById('dataX4').value);
                const dataY = parseData(document.getElementById('dataY4').value);
                const confidence = parseInt(document.getElementById('confidence4').value);
                
                if (dataX.length !== dataY.length) {
                    throw new Error('Los datos X e Y deben tener el mismo tama√±o');
                }
                
                if (dataX.length < 3) {
                    throw new Error('Se necesitan al menos 3 pares de datos');
                }
                
                const originalCorr = correlation(dataX, dataY);
                
                const bootstrapCorrs = [];
                for (let i = 0; i < bootstrapSamples; i++) {
                    const indices = Array.from({length: dataX.length}, () => Math.floor(Math.random() * dataX.length));
                    const sampleX = indices.map(i => dataX[i]);
                    const sampleY = indices.map(i => dataY[i]);
                    bootstrapCorrs.push(correlation(sampleX, sampleY));
                }
                
                const [lower, upper] = confidenceInterval(bootstrapCorrs, confidence);
                const significantCorr = (lower > 0 && upper > 0) || (lower < 0 && upper < 0);
                
                const results = `
                    <h4>üìä Resultados - Correlaci√≥n Bootstrap</h4>
                    <div class="result-item">
                        <strong>üìä Correlaci√≥n Original:</strong> ${originalCorr.toFixed(4)}
                    </div>
                    <div class="result-item">
                        <strong>üî¢ Correlaci√≥n Bootstrap:</strong> ${mean(bootstrapCorrs).toFixed(4)}
                    </div>
                    <div class="result-item">
                        <strong>üìà Intervalo de Confianza ${confidence}%:</strong> [${lower.toFixed(4)}, ${upper.toFixed(4)}]
                    </div>
                    <div class="result-item">
                        <strong>üí° Interpretaci√≥n:</strong> ${significantCorr ? 
                            `Hay una correlaci√≥n ${originalCorr > 0 ? 'positiva' : 'negativa'} significativa entre horas de estudio y calificaciones.` : 
                            'No hay correlaci√≥n significativa (el IC incluye el 0).'}
                    </div>
                `;
                
                showResults(4, results);
                createHistogram(bootstrapCorrs, 'Distribuci√≥n Bootstrap de la Correlaci√≥n');
                
            } catch (error) {
                showResults(4, `<div class="error">‚ùå Error: ${error.message}</div>`);
            }
        }

        // Exercise 5: Mediana y Percentiles
        function calculateExercise5() {
            try {
                const data = parseData(document.getElementById('data5').value);
                const confidence = parseInt(document.getElementById('confidence5').value);
                
                if (data.length < 2) {
                    throw new Error('Se necesitan al menos 2 datos');
                }
                
                const originalMedian = median(data);
                const originalP25 = percentile(data, 25);
                const originalP75 = percentile(data, 75);
                
                const bootstrapMedians = bootstrap(data, median, bootstrapSamples);
                const bootstrapP25 = bootstrap(data, arr => percentile(arr, 25), bootstrapSamples);
                const bootstrapP75 = bootstrap(data, arr => percentile(arr, 75), bootstrapSamples);
                
                const [medianLower, medianUpper] = confidenceInterval(bootstrapMedians, confidence);
                const [p25Lower, p25Upper] = confidenceInterval(bootstrapP25, confidence);
                const [p75Lower, p75Upper] = confidenceInterval(bootstrapP75, confidence);
                
                const results = `
                    <h4>üìä Resultados - Mediana y Percentiles</h4>
                    <div class="result-item">
                        <strong>üìä Mediana Original:</strong> ${originalMedian.toFixed(4)} miles
                    </div>
                    <div class="result-item">
                        <strong>üìà IC ${confidence}% Mediana:</strong> [${medianLower.toFixed(4)}, ${medianUpper.toFixed(4)}] miles
                    </div>
                    <div class="result-item">
                        <strong>üìä Percentil 25:</strong> ${originalP25.toFixed(4)} miles | IC: [${p25Lower.toFixed(4)}, ${p25Upper.toFixed(4)}]
                    </div>
                    <div class="result-item">
                        <strong>üìä Percentil 75:</strong> ${originalP75.toFixed(4)} miles | IC: [${p75Lower.toFixed(4)}, ${p75Upper.toFixed(4)}]
                    </div>
                    <div class="result-item">
                        <strong>üí° Interpretaci√≥n:</strong> El 50% de empleados gana entre ${originalP25.toFixed(2)} y ${originalP75.toFixed(2)} miles. La mediana poblacional est√° entre ${medianLower.toFixed(2)} y ${medianUpper.toFixed(2)} miles.
                    </div>
                `;
                
                showResults(5, results);
                createHistogram(bootstrapMedians, 'Distribuci√≥n Bootstrap de la Mediana');
                
            } catch (error) {
                showResults(5, `<div class="error">‚ùå Error: ${error.message}</div>`);
            }
        }

        // Exercise 6: Raz√≥n de Varianzas
        function calculateExercise6() {
            try {
                const dataA = parseData(document.getElementById('dataA6').value);
                const dataB = parseData(document.getElementById('dataB6').value);
                const confidence = parseInt(document.getElementById('confidence6').value);
                
                if (dataA.length < 2 || dataB.length < 2) {
                    throw new Error('Cada proceso necesita al menos 2 datos');
                }
                
                const varA = variance(dataA);
                const varB = variance(dataB);
                const ratio = varA / varB;
                
                const bootstrapRatios = [];
                for (let i = 0; i < bootstrapSamples; i++) {
                    const sampleA = bootstrap(dataA, variance, 1)[0];
                    const sampleB = bootstrap(dataB, variance, 1)[0];
                    bootstrapRatios.push(sampleA / sampleB);
                }
                
                const [lower, upper] = confidenceInterval(bootstrapRatios, confidence);
                const significantDiff = lower > 1 || upper < 1;
                
                const results = `
                    <h4>‚öñÔ∏è Resultados - Raz√≥n de Varianzas</h4>
                    <div class="result-item">
                        <strong>üìä Varianza Proceso 1:</strong> ${varA.toFixed(6)}
                    </div>
                    <div class="result-item">
                        <strong>üìä Varianza Proceso 2:</strong> ${varB.toFixed(6)}
                    </div>
                    <div class="result-item">
                        <strong>üî¢ Raz√≥n (Var1/Var2):</strong> ${ratio.toFixed(4)}
                    </div>
                    <div class="result-item">
                        <strong>üìà IC ${confidence}% para la raz√≥n:</strong> [${lower.toFixed(4)}, ${upper.toFixed(4)}]
                    </div>
                    <div class="result-item">
                        <strong>üí° Interpretaci√≥n:</strong> ${significantDiff ? 
                            `Hay diferencia significativa en variabilidad. El Proceso ${ratio > 1 ? '1 es m√°s variable' : '2 es m√°s variable'}.` : 
                            'No hay diferencia significativa en variabilidad (el IC incluye el 1).'}
                    </div>
                `;
                
                showResults(6, results);
                createHistogram(bootstrapRatios, 'Distribuci√≥n Bootstrap de la Raz√≥n de Varianzas');
                
            } catch (error) {
                showResults(6, `<div class="error">‚ùå Error: ${error.message}</div>`);
            }
        }

        // Exercise 7: Regresi√≥n
        function calculateExercise7() {
            try {
                const dataX = parseData(document.getElementById('dataX7').value);
                const dataY = parseData(document.getElementById('dataY7').value);
                const confidence = parseInt(document.getElementById('confidence7').value);
                
                if (dataX.length !== dataY.length) {
                    throw new Error('Los datos X e Y deben tener el mismo tama√±o');
                }
                
                if (dataX.length < 3) {
                    throw new Error('Se necesitan al menos 3 pares de datos');
                }
                
                const originalReg = linearRegression(dataX, dataY);
                
                const bootstrapSlopes = [];
                const bootstrapIntercepts = [];
                
                for (let i = 0; i < bootstrapSamples; i++) {
                    const indices = Array.from({length: dataX.length}, () => Math.floor(Math.random() * dataX.length));
                    const sampleX = indices.map(i => dataX[i]);
                    const sampleY = indices.map(i => dataY[i]);
                    const reg = linearRegression(sampleX, sampleY);
                    bootstrapSlopes.push(reg.slope);
                    bootstrapIntercepts.push(reg.intercept);
                }
                
                const [slopeLower, slopeUpper] = confidenceInterval(bootstrapSlopes, confidence);
                const [interceptLower, interceptUpper] = confidenceInterval(bootstrapIntercepts, confidence);
                
                const results = `
                    <h4>üìà Resultados - Regresi√≥n Bootstrap</h4>
                    <div class="result-item">
                        <strong>üìä Pendiente Original:</strong> ${originalReg.slope.toFixed(4)}
                    </div>
                    <div class="result-item">
                        <strong>üìà IC ${confidence}% Pendiente:</strong> [${slopeLower.toFixed(4)}, ${slopeUpper.toFixed(4)}]
                    </div>
                    <div class="result-item">
                        <strong>üìä Intercepto Original:</strong> ${originalReg.intercept.toFixed(4)}
                    </div>
                    <div class="result-item">
                        <strong>üìà IC ${confidence}% Intercepto:</strong> [${interceptLower.toFixed(4)}, ${interceptUpper.toFixed(4)}]
                    </div>
                    <div class="result-item">
                        <strong>üí° Interpretaci√≥n:</strong> Por cada unidad adicional de publicidad, las ventas aumentan entre ${slopeLower.toFixed(2)} y ${slopeUpper.toFixed(2)} unidades.
                    </div>
                `;
                
                showResults(7, results);
                createHistogram(bootstrapSlopes, 'Distribuci√≥n Bootstrap de la Pendiente');
                
            } catch (error) {
                showResults(7, `<div class="error">‚ùå Error: ${error.message}</div>`);
            }
        }

        // Exercise 8: Diferencia de Proporciones
        function calculateExercise8() {
            try {
                const dataA = parseData(document.getElementById('dataA8').value);
                const dataB = parseData(document.getElementById('dataB8').value);
                const confidence = parseInt(document.getElementById('confidence8').value);
                
                if (!dataA.every(x => x === 0 || x === 1) || !dataB.every(x => x === 0 || x === 1)) {
                    throw new Error('Los datos deben ser solo 0s y 1s');
                }
                
                const propA = mean(dataA);
                const propB = mean(dataB);
                const difference = propA - propB;
                
                const bootstrapDifferences = [];
                for (let i = 0; i < bootstrapSamples; i++) {
                    const sampleA = bootstrap(dataA, mean, 1)[0];
                    const sampleB = bootstrap(dataB, mean, 1)[0];
                    bootstrapDifferences.push(sampleA - sampleB);
                }
                
                const [lower, upper] = confidenceInterval(bootstrapDifferences, confidence);
                const significantDiff = (lower > 0 && upper > 0) || (lower < 0 && upper < 0);
                
                const results = `
                    <h4>‚öñÔ∏è Resultados - Diferencia de Proporciones</h4>
                    <div class="result-item">
                        <strong>üìä Proporci√≥n Tratamiento A:</strong> ${(propA * 100).toFixed(2)}%
                    </div>
                    <div class="result-item">
                        <strong>üìä Proporci√≥n Tratamiento B:</strong> ${(propB * 100).toFixed(2)}%
                    </div>
                    <div class="result-item">
                        <strong>üî¢ Diferencia (A - B):</strong> ${(difference * 100).toFixed(2)}%
                    </div>
                    <div class="result-item">
                        <strong>üìà IC ${confidence}% para la diferencia:</strong> [${(lower * 100).toFixed(2)}%, ${(upper * 100).toFixed(2)}%]
                    </div>
                    <div class="result-item">
                        <strong>üí° Interpretaci√≥n:</strong> ${significantDiff ? 
                            `Hay diferencia significativa. El Tratamiento ${difference > 0 ? 'A es m√°s efectivo' : 'B es m√°s efectivo'}.` : 
                            'No hay diferencia significativa entre tratamientos (el IC incluye el 0).'}
                    </div>
                `;
                
                showResults(8, results);
                createHistogram(bootstrapDifferences, 'Distribuci√≥n Bootstrap de la Diferencia de Proporciones');
                
            } catch (error) {
                showResults(8, `<div class="error">‚ùå Error: ${error.message}</div>`);
            }
        }

        // Exercise 9: Bootstrap Param√©trico
        function calculateExercise9() {
            try {
                const data = parseData(document.getElementById('data9').value);
                const confidence = parseInt(document.getElementById('confidence9').value);
                
                if (data.length < 2) {
                    throw new Error('Se necesitan al menos 2 datos');
                }
                
                const originalLambda = 1 / mean(data);
                const originalMeanLife = mean(data);
                
                const bootstrapLambdas = [];
                const bootstrapMeanLifes = [];
                
                for (let i = 0; i < bootstrapSamples; i++) {
                    // Generar muestra de distribuci√≥n exponencial
                    const sample = [];
                    for (let j = 0; j < data.length; j++) {
                        const u = Math.random();
                        const x = -Math.log(u) / originalLambda;
                        sample.push(x);
                    }
                    const lambda = 1 / mean(sample);
                    bootstrapLambdas.push(lambda);
                    bootstrapMeanLifes.push(mean(sample));
                }
                
                const [lambdaLower, lambdaUpper] = confidenceInterval(bootstrapLambdas, confidence);
                const [lifeLower, lifeUpper] = confidenceInterval(bootstrapMeanLifes, confidence);
                
                const results = `
                    <h4>üìä Resultados - Bootstrap Param√©trico</h4>
                    <div class="result-item">
                        <strong>üìä Par√°metro Œª Original:</strong> ${originalLambda.toFixed(6)} (1/d√≠as)
                    </div>
                    <div class="result-item">
                        <strong>üìà IC ${confidence}% para Œª:</strong> [${lambdaLower.toFixed(6)}, ${lambdaUpper.toFixed(6)}]
                    </div>
                    <div class="result-item">
                        <strong>üìä Vida Media Original:</strong> ${originalMeanLife.toFixed(2)} d√≠as
                    </div>
                    <div class="result-item">
                        <strong>üìà IC ${confidence}% Vida Media:</strong> [${lifeLower.toFixed(2)}, ${lifeUpper.toFixed(2)}] d√≠as
                    </div>
                    <div class="result-item">
                        <strong>üí° Interpretaci√≥n:</strong> Los componentes tienen una vida media entre ${lifeLower.toFixed(1)} y ${lifeUpper.toFixed(1)} d√≠as bajo distribuci√≥n exponencial.
                    </div>
                `;
                
                showResults(9, results);
                createHistogram(bootstrapMeanLifes, 'Distribuci√≥n Bootstrap de la Vida Media');
                
            } catch (error) {
                showResults(9, `<div class="error">‚ùå Error: ${error.message}</div>`);
            }
        }

        // Exercise 10: Bootstrap por Bloques
        function calculateExercise10() {
            try {
                const data = parseData(document.getElementById('data10').value);
                const blockSize = parseInt(document.getElementById('blockSize10').value);
                const confidence = parseInt(document.getElementById('confidence10').value);
                
                if (data.length < blockSize) {
                    throw new Error('El tama√±o de bloque debe ser menor que el tama√±o de los datos');
                }
                
                const originalVolatility = standardDeviation(data);
                
                const bootstrapVolatilities = [];
                
                for (let i = 0; i < bootstrapSamples; i++) {
                    const sample = [];
                    while (sample.length < data.length) {
                        const startIndex = Math.floor(Math.random() * (data.length - blockSize + 1));
                        const block = data.slice(startIndex, startIndex + blockSize);
                        sample.push(...block);
                    }
                    const volatility = standardDeviation(sample.slice(0, data.length));
                    bootstrapVolatilities.push(volatility);
                }
                
                const [lower, upper] = confidenceInterval(bootstrapVolatilities, confidence);
                
                const results = `
                    <h4>üìà Resultados - Bootstrap por Bloques</h4>
                    <div class="result-item">
                        <strong>üìä Volatilidad Original:</strong> ${originalVolatility.toFixed(4)}%
                    </div>
                    <div class="result-item">
                        <strong>üî¢ Volatilidad Bootstrap:</strong> ${mean(bootstrapVolatilities).toFixed(4)}%
                    </div>
                    <div class="result-item">
                        <strong>üìà IC ${confidence}% Volatilidad:</strong> [${lower.toFixed(4)}%, ${upper.toFixed(4)}%]
                    </div>
                    <div class="result-item">
                        <strong>üîß Tama√±o de Bloque:</strong> ${blockSize} observaciones
                    </div>
                    <div class="result-item">
                        <strong>üí° Interpretaci√≥n:</strong> La volatilidad real de los retornos est√° entre ${lower.toFixed(3)}% y ${upper.toFixed(3)}%, considerando la dependencia temporal.
                    </div>
                `;
                
                showResults(10, results);
                createHistogram(bootstrapVolatilities, 'Distribuci√≥n Bootstrap de la Volatilidad');
                
            } catch (error) {
                showResults(10, `<div class="error">‚ùå Error: ${error.message}</div>`);
            }
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            selectExercise(1);
        });
    </script>
</body>
</html>
